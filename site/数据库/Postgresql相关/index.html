<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://wiki.xlz2021.cf/%E6%95%B0%E6%8D%AE%E5%BA%93/Postgresql%E7%9B%B8%E5%85%B3/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Postgresql相关 - 玄凌子知识库</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/java.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/kotlin.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">玄凌子知识库</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">关于我</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Java <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Java/JPA%E5%88%86%E9%A1%B5%E6%9C%80%E5%A4%A7%E6%9D%A1%E6%95%B0%E9%99%90%E5%88%B6%E4%BF%AE%E6%94%B9/" class="dropdown-item">JPA分页最大条数限制修改</a>
</li>
                                    
<li>
    <a href="../../Java/Maven/" class="dropdown-item">Maven 使用</a>
</li>
                                    
<li>
    <a href="../../Java/github%E8%AE%BF%E9%97%AE/" class="dropdown-item">Github访问</a>
</li>
                                    
<li>
    <a href="../../Java/gradle%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84/" class="dropdown-item">Gradle自定义存储路径</a>
</li>
                                    
<li>
    <a href="../../Java/logback%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF/" class="dropdown-item">Logback配置模板</a>
</li>
                                    
<li>
    <a href="../../Java/mvn%E6%89%A7%E8%A1%8C%E6%B7%B7%E7%94%A8jdk8%E5%92%8C11/" class="dropdown-item">Mvn执行混用jdk8和11</a>
</li>
                                    
<li>
    <a href="../../Java/openjdk%E6%97%A0%E6%B3%95%E7%94%9F%E6%88%90%E9%AA%8C%E8%AF%81%E7%A0%81%E8%A7%A3%E5%86%B3/" class="dropdown-item">基于alpine的openjdk8无法生成验证码的解决</a>
</li>
                                    
<li>
    <a href="../../Java/%E4%BF%9D%E7%95%99%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98/" class="dropdown-item">保留端口占用问题</a>
</li>
                                    
<li>
    <a href="../../Java/%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" class="dropdown-item">YYYY和yyyy的区别</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Python/JupyterNotebook%E5%AE%89%E8%A3%85/" class="dropdown-item">Jupyter Notebook 安装</a>
</li>
                                    
<li>
    <a href="../../Python/pypi%E6%BA%90/" class="dropdown-item">Pypi源</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%9C%AF/" class="dropdown-item">图片隐写术</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%AE%89%E8%A3%85ta-lib/" class="dropdown-item">安装ta lib</a>
</li>
                                    
<li>
    <a href="../../Python/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/" class="dropdown-item">打包工具</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Docker <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../docker/Centos%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85docker/" class="dropdown-item">Centos在线安装docker</a>
</li>
                                    
<li>
    <a href="../../docker/K3S%E5%AE%89%E8%A3%85/" class="dropdown-item">K3S安装</a>
</li>
                                    
<li>
    <a href="../../docker/Linux%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85docker/" class="dropdown-item">Linux在线安装docker</a>
</li>
                                    
<li>
    <a href="../../docker/Pg14%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA/" class="dropdown-item">Pg14生产环境镜像构建</a>
</li>
                                    
<li>
    <a href="../../docker/Swarm%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" class="dropdown-item">Swarm集群使用说明</a>
</li>
                                    
<li>
    <a href="../../docker/debian%E6%9B%B4%E6%96%B0source/" class="dropdown-item">debian容器更新source.list</a>
</li>
                                    
<li>
    <a href="../../docker/docker%E5%AE%B9%E5%99%A8%E5%87%BA%E7%8E%B0%E6%93%8D%E4%BD%9C%E4%B8%8D%E5%85%81%E8%AE%B8%E9%94%99%E8%AF%AF/" class="dropdown-item">Docker容器出现操作不允许错误</a>
</li>
                                    
<li>
    <a href="../../docker/docker%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3/" class="dropdown-item">docker容器相关</a>
</li>
                                    
<li>
    <a href="../../docker/seaweedfs%E4%BD%9C%E4%B8%BA%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E6%8F%92%E4%BB%B6/" class="dropdown-item">Seaweedfs作为分布式存储插件</a>
</li>
                                    
<li>
    <a href="../../docker/wsl2%E6%A1%A5%E6%8E%A5/" class="dropdown-item">Wsl2桥接</a>
</li>
                                    
<li>
    <a href="../../docker/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84nfs%E6%9C%8D%E5%8A%A1/" class="dropdown-item">基于容器的nfs服务</a>
</li>
                                    
<li>
    <a href="../../docker/%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" class="dropdown-item">容器使用注意事项</a>
</li>
                                    
<li>
    <a href="../../docker/%E7%A6%81%E6%AD%A2%E5%AE%B9%E5%99%A8%E8%AE%BF%E9%97%AE%E5%A4%96%E7%BD%91/" class="dropdown-item">禁止容器访问外网</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linux <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../linux/Alpine%E4%BD%BF%E7%94%A8%E6%B8%85%E5%8D%8E%E6%BA%90/" class="dropdown-item">Alpine使用清华源</a>
</li>
                                    
<li>
    <a href="../../linux/CentOS%E5%AE%8C%E7%BE%8E%E5%8D%87%E7%BA%A7gcc%E7%89%88%E6%9C%AC%E6%96%B9%E6%B3%95/" class="dropdown-item">CentOS完美升级gcc版本方法</a>
</li>
                                    
<li>
    <a href="../../linux/Centos7%E6%9B%B4%E6%96%B0%E5%86%85%E6%A0%B8/" class="dropdown-item">Centos7更新内核</a>
</li>
                                    
<li>
    <a href="../../linux/Centos7%E6%9B%B4%E6%96%B0%E8%87%AA%E5%B8%A6%E7%9A%84openssh%E4%BF%AE%E5%A4%8D%E6%BC%8F%E6%B4%9E/" class="dropdown-item">Centos7更新openssh修复漏洞</a>
</li>
                                    
<li>
    <a href="../../linux/FIO%E6%B5%8B%E8%AF%95%E7%A3%81%E7%9B%98IO/" class="dropdown-item">FIO测试磁盘IO</a>
</li>
                                    
<li>
    <a href="../../linux/Linux_LVM%E5%88%86%E5%8C%BA%E6%89%A9%E5%AE%B9/" class="dropdown-item">LVM分区扩容</a>
</li>
                                    
<li>
    <a href="../../linux/Nginx%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/" class="dropdown-item">Nginx配置说明</a>
</li>
                                    
<li>
    <a href="../../linux/centos7_selinux/" class="dropdown-item">修复Centos7的SELINUX错误</a>
</li>
                                    
<li>
    <a href="../../linux/centos7%E5%8D%95%E7%94%A8%E6%88%B7%E6%A8%A1%E5%BC%8F/" class="dropdown-item">Centos7单用户模式</a>
</li>
                                    
<li>
    <a href="../../linux/centos_update_gcc/" class="dropdown-item">CentOS完美升级gcc版本方法</a>
</li>
                                    
<li>
    <a href="../../linux/cron/" class="dropdown-item">cron定时任务常见问题</a>
</li>
                                    
<li>
    <a href="../../linux/cron%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="dropdown-item">Cron定时任务常见问题</a>
</li>
                                    
<li>
    <a href="../../linux/cron%E9%98%B2%E6%AD%A2%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C/" class="dropdown-item">cron防止重复执行</a>
</li>
                                    
<li>
    <a href="../../linux/iperf3%E5%B8%A6%E5%AE%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">Iperf3带宽测试</a>
</li>
                                    
<li>
    <a href="../../linux/n2n/" class="dropdown-item">服务节点</a>
</li>
                                    
<li>
    <a href="../../linux/net_safe/" class="dropdown-item">网络安全防护</a>
</li>
                                    
<li>
    <a href="../../linux/net_speed_test/" class="dropdown-item">带宽测试</a>
</li>
                                    
<li>
    <a href="../../linux/nfs%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8/" class="dropdown-item">nfs搭建与使用</a>
</li>
                                    
<li>
    <a href="../../linux/nginx/" class="dropdown-item">nginx负载均衡</a>
</li>
                                    
<li>
    <a href="../../linux/tcpdump%E6%8A%93%E5%8C%85/" class="dropdown-item">tcpdump抓包</a>
</li>
                                    
<li>
    <a href="../../linux/update_centos7_kernel/" class="dropdown-item">Centos7 升级内核版本</a>
</li>
                                    
<li>
    <a href="../../linux/%E4%BF%AE%E5%A4%8DCentos7%E7%9A%84SELINUX%E9%94%99%E8%AF%AF/" class="dropdown-item">修复Centos7的SELINUX错误</a>
</li>
                                    
<li>
    <a href="../../linux/%E5%90%84%E9%A1%B9%E6%80%A7%E8%83%BD%E5%8F%82%E6%95%B0%E7%9B%91%E6%B5%8B/" class="dropdown-item">性能参数监测</a>
</li>
                                    
<li>
    <a href="../../linux/%E5%9C%A8linux%E9%80%9A%E8%BF%87docker%E8%BF%90%E8%A1%8C%E5%BE%AE%E4%BF%A1/" class="dropdown-item">在linux通过docker运行微信</a>
</li>
                                    
<li>
    <a href="../../linux/%E6%96%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/" class="dropdown-item">新服务器基本配置流程</a>
</li>
                                    
<li>
    <a href="../../linux/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/" class="dropdown-item">网络安全防护</a>
</li>
                                    
<li>
    <a href="../../linux/%E9%92%88%E5%AF%B9%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6%E7%9A%84NFS%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0/" class="dropdown-item">针对大数据组件的NFS挂载参数</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Store <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../store/seaweedfs/" class="dropdown-item">Seaweedfs</a>
</li>
                                    
<li>
    <a href="../../store/%E5%90%8C%E7%A8%8B%E6%97%85%E8%A1%8Cseaweedfs%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="dropdown-item">同程旅行Seaweedfs最佳实践</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">中医 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E4%BA%94%E6%AD%A5%E5%AD%A6%E7%BA%AF%E6%AD%A3%E4%B8%AD%E5%8C%BB/" class="dropdown-item">倪海厦｜跟着这五个步骤学好纯正中医</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E5%A4%A7%E5%8C%BB%E7%B2%BE%E8%AF%9A/" class="dropdown-item">大医精诚</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%84%9F%E5%86%92%E7%BB%8F%E6%96%B9%E9%80%89%E8%8D%AF%E5%9B%BE/" class="dropdown-item">感冒经方选药图</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%9C%AC%E8%8D%89/" class="dropdown-item">本草笔记</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%B1%A4%E6%B6%B2%E7%BB%8F%E6%B3%95/" class="dropdown-item">汤液经法</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E8%8D%AF%E9%A3%9F%E5%90%8C%E6%BA%90%E7%9B%AE%E5%BD%952023/" class="dropdown-item">药食同源目录2023</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">灵枢</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E4%B8%AD%E5%8C%BB%E5%9F%BA%E7%A1%80/" class="dropdown-item">中医基础</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="dropdown-item">人纪针灸学习笔记</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B0%8F%E5%84%BF%E4%B8%80%E8%88%AC%E6%84%9F%E5%86%92%E9%87%8D%E6%84%9F%E5%86%92%E7%A7%AF%E9%A3%9F%E7%9A%84%E6%8E%A8%E6%8B%BF%E6%89%8B%E6%B3%95/" class="dropdown-item">**小儿一般感冒重感冒积食的推拿手法**</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B8%B8%E7%94%A8%E5%85%BB%E7%94%9F%E7%A9%B4%E4%BD%8D/" class="dropdown-item">常用养生穴位</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B8%B8%E8%A7%81%E7%97%85%E7%A9%B4%E4%BD%8D%E7%96%97%E6%B3%95/" class="dropdown-item">常见病穴位疗法</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E7%83%A7%E5%B1%B1%E7%81%AB%E4%B8%8E%E9%80%8F%E5%A4%A9%E5%87%89%E6%89%8B%E6%B3%95/" class="dropdown-item">烧山火与透天凉手法</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E7%BB%8F%E7%BB%9C%E5%B9%B2%E6%94%AF/" class="dropdown-item">经络天干</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E9%AB%98%E8%A1%80%E5%8E%8B%E8%BE%A8%E8%AF%81%E4%B8%8E%E6%96%B9%E9%92%88/" class="dropdown-item">高血压辨证与方针</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E9%BA%A6%E7%B2%92%E8%82%BF%E8%BE%A9%E8%AF%81%E4%B8%8E%E6%96%B9%E9%92%88/" class="dropdown-item">麦粒肿辩证与方针</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">素问</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E5%B8%B8%E7%94%A8%E6%96%B9%E5%89%82/" class="dropdown-item">常用方剂</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%95%91%E5%91%BD%E7%A8%BB%E8%8D%89/" class="dropdown-item">救命稻草</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%96%B0%E6%96%87%E6%A1%A3/" class="dropdown-item">新文档</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%B1%A4%E5%A4%B4%E6%AD%8C%E8%AF%80/" class="dropdown-item">汤头歌诀</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E9%BB%84%E5%B8%9D%E5%86%85%E7%BB%8F_%E5%85%BB%E7%94%9F/" class="dropdown-item">黄帝内经_养生</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">人工智能 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95%E4%BC%98%E7%BC%BA%E7%82%B9/" class="dropdown-item">常见算法优缺点</a>
</li>
                                    
<li>
    <a href="../../%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/" class="dropdown-item">语言模型原理</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">修行 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E4%BB%99%E4%BC%A0%E7%8E%84%E6%9C%BA%E5%8F%A3%E8%AF%80/" class="dropdown-item">仙传玄机口诀</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E4%BF%AE%E8%A1%8C%E5%87%BA%E5%81%8F/" class="dropdown-item">修行出偏</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E4%B8%8B%E6%89%8B%E5%90%8E%E6%AC%B2%E6%9C%9B%E5%BC%BA%E7%83%88%E7%9A%84%E9%97%AE%E9%A2%98/" class="dropdown-item">关于丹道下手后欲望强烈的问题</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E5%88%9D%E5%AD%A6%E8%80%85%E4%B8%8B%E6%89%8B%E5%AE%9E%E4%BF%AE%E5%8A%9F%E5%A4%AB/" class="dropdown-item">关于丹道初学者下手实修功夫</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E6%B2%BB%E7%97%85/" class="dropdown-item">关于丹道治病</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%A5%B3%E7%94%9F%E6%83%B3%E8%A6%81%E4%BF%AE%E9%81%93%E8%A6%81%E6%80%8E%E4%B9%88%E5%81%9A/" class="dropdown-item">女生修道怎么做-两篇</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%96%B0%E4%BA%BA%E4%B8%B9%E9%81%93%E9%81%BF%E5%9D%91/" class="dropdown-item">新人丹道避坑</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%9C%89%E4%BA%BA%E8%AF%B4%E4%B8%B9%E9%81%93%E7%81%AB%E5%80%99%E4%B8%8D%E8%83%BD%E9%9D%A0%E8%87%AA%E5%B7%B1%E6%8F%A3%E6%91%A9%EF%BC%8C%E5%8F%AA%E8%83%BD%E9%9D%A0%E5%B8%88%E6%89%BF%E5%8F%A3%E8%AF%80%E3%80%82%E9%82%A3%E4%B9%88%EF%BC%8C%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9A%84%E5%8A%9F%E6%B3%95%E6%98%AF%E5%A6%82%E4%BD%95%E5%87%BA%E7%8E%B0%E7%9A%84/" class="dropdown-item">有人说丹道火候不能靠自己揣摩，只能靠师承口诀。那么，最开始的功法是如何出现的</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%B8%85%E9%9D%99%E7%BB%8F/" class="dropdown-item">清静经</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E7%A5%9E%E6%A3%8D%E7%90%86%E8%AE%BA/" class="dropdown-item">神棍理论</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">前端 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E5%89%8D%E7%AB%AF/node_sass/" class="dropdown-item">Node sass</a>
</li>
                                    
<li>
    <a href="../../%E5%89%8D%E7%AB%AF/nodejs%E7%8E%AF%E5%A2%83/" class="dropdown-item">Nodejs环境</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">大数据 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ES%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="dropdown-item">ES性能指标</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch/" class="dropdown-item">ElasticSearch技巧</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E4%BD%BF%E7%94%A8/" class="dropdown-item">Elasticsearch使用</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E5%A4%A7%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/" class="dropdown-item">大版本升级方案</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E6%8A%80%E5%B7%A7/" class="dropdown-item">ElasticSearch技巧</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink_sql_ETL%E9%9B%86%E5%90%88/" class="dropdown-item">Flink-sql-ETL集合</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink%E5%B8%B8%E7%94%A8%E8%BF%9E%E6%8E%A5%E5%99%A8%E8%AF%BB%E5%86%99%E8%83%BD%E5%8A%9B%E6%B1%87%E6%80%BB/" class="dropdown-item">Flink常用connector支持情况</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/GP%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/" class="dropdown-item">GP常用配置项</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Greenplum%E7%A7%BB%E9%99%A4Segment/" class="dropdown-item">Greenplum移除Segment</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E7%9B%B8%E5%85%B3/" class="dropdown-item">Kafka相关</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98%E6%B5%8B%E8%AF%95/" class="dropdown-item">kafka调优</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E8%B0%83%E4%BC%98%E7%9B%B8%E5%85%B3/" class="dropdown-item">Kafka调优相关</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_spark/" class="dropdown-item">cdh编写spark依赖问题</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flinksql%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/" class="dropdown-item">Flinksql常用参数设置</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flink%E9%85%8D%E7%BD%AE%E8%B0%83%E4%BC%98/" class="dropdown-item">flink 配置调优</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flink%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">flink集群搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/gp6%E5%BA%93%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">Gp6库性能测试</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/greenplum%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8/" class="dropdown-item">greenplum集群使用</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/greenplum%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">greenplum集群搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/kafka%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">kafka性能测试</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/mysql/" class="dropdown-item">Mysql</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8EDinky%E7%9A%84cdc%E6%95%B4%E5%BA%93%E5%90%8C%E6%AD%A5/" class="dropdown-item">基于Dinky的cdc整库同步</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84dinky_flink_kafka/" class="dropdown-item">基于容器的dinky和flink以及kafka</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84pyflink/" class="dropdown-item">使用基于容器的pyflink</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%B8%A6%E5%AF%86%E7%A0%81%E7%9A%84kafka%E9%83%A8%E7%BD%B2/" class="dropdown-item">带用户密码的kafka搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83kafka%E9%85%8D%E7%BD%AE/" class="dropdown-item">生产环境kafka配置说明</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">数据库 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Arm64%E7%89%88%E6%9C%ACCitus%E8%AF%B4%E6%98%8E/" class="dropdown-item">初始化数据库</a>
</li>
                                    
<li>
    <a href="../Citus%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8/" class="dropdown-item">Citus集群使用</a>
</li>
                                    
<li>
    <a href="../GP_MDB%E9%9B%86%E7%BE%A4%E5%86%85%E5%AD%98%E9%85%8D%E7%BD%AE/" class="dropdown-item">gp/mdb集群内存配置</a>
</li>
                                    
<li>
    <a href="../Lcpg%E5%86%85%E9%83%A8%E5%8F%91%E8%A1%8C%E7%89%88%E4%BD%BF%E7%94%A8/" class="dropdown-item">Lcpg内部发行版使用</a>
</li>
                                    
<li>
    <a href="../Mariadb%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/" class="dropdown-item">Mariadb主从复制</a>
</li>
                                    
<li>
    <a href="../Mariadb%E5%A4%9A%E4%B8%BB%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">Mariadb多主集群搭建</a>
</li>
                                    
<li>
    <a href="../Mysql%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D/" class="dropdown-item">mysql故障恢复</a>
</li>
                                    
<li>
    <a href="../Neo4j%E7%9B%B8%E5%85%B3/" class="dropdown-item">Neo4j相关</a>
</li>
                                    
<li>
    <a href="../Pg%E5%8E%9F%E7%94%9F%E9%9B%86%E7%BE%A4%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8/" class="dropdown-item">PG原生集群复制配置与高可用</a>
</li>
                                    
<li>
    <a href="../Postgresql/" class="dropdown-item">Postgresql相关</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Postgresql相关</a>
</li>
                                    
<li>
    <a href="../Postgresql%E9%9B%86%E7%BE%A4/" class="dropdown-item">pg集群搭建</a>
</li>
                                    
<li>
    <a href="../Redis%E4%BD%BF%E7%94%A8%E7%9B%B8%E5%85%B3/" class="dropdown-item">Redis相关</a>
</li>
                                    
<li>
    <a href="../Redis%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3/" class="dropdown-item">Redis集群相关</a>
</li>
                                    
<li>
    <a href="../gp_mdb%E7%A1%AC%E4%BB%B6%E9%80%89%E5%9E%8B%E8%AE%A1%E5%88%92/" class="dropdown-item">gp与mdb硬件选型计划</a>
</li>
                                    
<li>
    <a href="../mysql_mariadb/" class="dropdown-item">mysql/mariadb</a>
</li>
                                    
<li>
    <a href="../mysql%E5%88%A0%E9%99%A4%E5%A4%A7%E8%A1%A8/" class="dropdown-item">mysql删除大表</a>
</li>
                                    
<li>
    <a href="../mysql%E6%88%96mariadb/" class="dropdown-item">Mysql或mariadb</a>
</li>
                                    
<li>
    <a href="../neo4j/" class="dropdown-item">Neo4j相关</a>
</li>
                                    
<li>
    <a href="../pipelinedb/" class="dropdown-item">pipelinedb流式数据库介绍</a>
</li>
                                    
<li>
    <a href="../pipelinedb%E6%B5%81%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/" class="dropdown-item">Pipelinedb流式数据库介绍</a>
</li>
                                    
<li>
    <a href="../timescaledb/" class="dropdown-item">Timescaledb</a>
</li>
                                    
<li>
    <a href="../%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" class="dropdown-item">时序数据库</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">架构设计 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E6%96%B0%E4%B8%9C%E8%A5%BF%E7%A7%AF%E7%B4%AF/" class="dropdown-item">新东西积累</a>
</li>
                                    
<li>
    <a href="../../%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E7%BB%8F%E9%AA%8C%E7%B4%AF%E7%A7%AF/" class="dropdown-item">经验累积</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">经济 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E4%BB%8E%E6%9C%9F%E8%B4%A7%E8%B5%9A%E5%88%B0%E4%B8%80%E5%8D%83%E4%B8%87/" class="dropdown-item">从期货赚到一千万</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E5%85%AD%E7%88%BB%E6%B5%8B%E8%82%A1%E7%A5%A8/" class="dropdown-item">六爻预测股票起卦方法（很重要）</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E5%BD%BC%E5%BE%97%E6%9E%97%E5%A5%87%E7%AC%94%E8%AE%B0/" class="dropdown-item">彼得林奇笔记</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E8%B6%85%E4%BD%8E%E4%BB%B7%E9%A2%84%E5%94%AE%E5%A5%97%E8%B7%AF/" class="dropdown-item">超低价预售套路</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Postgresql/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Postgresql%E9%9B%86%E7%BE%A4/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">常用配置</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">外部表</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">物化视图</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_5" class="nav-link">常用命令</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_7" class="nav-link">常用技巧</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_8" class="nav-link">锁处理</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#pg" class="nav-link">PG数据量限制</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_9" class="nav-link">生成随机数据</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="2"><a href="#_16" class="nav-link">创建用户</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h2 id="_1">常用配置</h2>
<h3 id="max_connections">max_connections</h3>
<p>允许的最大客户端连接数。这个参数设置大小和work_mem有一些关系。配置的越高，可能会占用系统更多的内存。通常可以设置数百个连接，如果要使用上千个连接，建议配置连接池来减少开销。</p>
<h3 id="shared_buffers">shared_buffers</h3>
<p>PostgreSQL使用自己的缓冲区，也使用Linux操作系统内核缓冲OS Cache。这就说明数据两次存储在内存中，首先是PostgreSQL缓冲区，然后是操作系统内核缓冲区。与其他数据库不同，PostgreSQL不提供直接IO，所以这又被称为双缓冲。PostgreSQL缓冲区称为shared_buffer，建议设置为物理内存的1/4。而实际配置取决于硬件配置和工作负载，如果你的内存很大，而你又想多缓冲一些数据到内存中，可以继续调大shared_buffer。</p>
<h3 id="effective_cache_size">Effective_cache_size</h3>
<p>这个参数主要用于Postgre查询优化器。是单个查询可用的磁盘高速缓存的有效大小的一个假设，是一个估算值，它并不占据系统内存。由于优化器需要进行估算成本，较高的值更有可能使用索引扫描，较低的值则有可能使用顺序扫描。一般这个值设置为内存的1/2是正常保守的设置，设置为内存的3/4是比较推荐的值。通过free命令查看操作系统的统计信息，您可能会更好的估算该值。</p>
<pre><code>[pg@e22 ~]$ free -g
              total        used        free      shared  buff/cache   available
Mem:             62           2           5          16          55          40
Swap:             7           0           7
</code></pre>
<h3 id="work_mem">work_mem</h3>
<p>这个参数主要用于写入临时文件之前内部排序操作和散列表使用的内存量，增加work_mem参数将使PostgreSQL可以进行更大的内存排序。这个参数和max_connections有一些关系，假设你设置为30MB，则40个用户同时执行查询排序，很快就会使用1.2GB的实际内存。同时对于复杂查询，可能会运行多个排序和散列操作，例如涉及到8张表进行合并排序，此时就需要8倍的work_mem。</p>
<p>如下面案例所示，该环境使用4MB的work_mem，在执行排序操作的时候，使用的Sort Method是external merge Disk。</p>
<pre><code>external merge Disk。

kms=&gt; explain (analyze,buffers) select * from KMS_BUSINESS_HALL_TOTAL  order by buss_query_info;
                                                                       QUERY PLAN                                                                      
---------------------------------------------------------------------------------------------------------------------------------------------------------
 Gather Merge  (cost=262167.99..567195.15 rows=2614336 width=52) (actual time=2782.203..5184.442 rows=3137204 loops=1)
   Workers Planned: 2
   Workers Launched: 2
   Buffers: shared hit=68 read=25939, temp read=28863 written=28947
   -&gt;  Sort  (cost=261167.97..264435.89 rows=1307168 width=52) (actual time=2760.566..3453.783 rows=1045735 loops=3)
         Sort Key: buss_query_info
         Sort Method: external merge  Disk: 50568kB
         Worker 0:  Sort Method: external merge  Disk: 50840kB
         Worker 1:  Sort Method: external merge  Disk: 49944kB
         Buffers: shared hit=68 read=25939, temp read=28863 written=28947
         -&gt;  Parallel Seq Scan on kms_business_hall_total  (cost=0.00..39010.68 rows=1307168 width=52) (actual time=0.547..259.524 rows=1045735 loops=3)
               Buffers: shared read=25939
 Planning Time: 0.540 ms
 Execution Time: 5461.516 ms
(14 rows)
</code></pre>
<p>当我们把参数修改成512MB的时候，可以看到Sort Method变成了quicksort Memory，变成了内存排序。</p>
<pre><code>kms=&gt; set work_mem to &quot;512MB&quot;;
SET
kms=&gt; explain (analyze,buffers) select * from KMS_BUSINESS_HALL_TOTAL  order by buss_query_info;
                                                                QUERY PLAN                                                              
------------------------------------------------------------------------------------------------------------------------------------------
 Sort  (cost=395831.79..403674.80 rows=3137204 width=52) (actual time=7870.826..8204.794 rows=3137204 loops=1)
   Sort Key: buss_query_info
   Sort Method: quicksort  Memory: 359833kB
   Buffers: shared hit=25939
   -&gt;  Seq Scan on kms_business_hall_total  (cost=0.00..57311.04 rows=3137204 width=52) (actual time=0.019..373.067 rows=3137204 loops=1)
         Buffers: shared hit=25939
 Planning Time: 0.081 ms
 Execution Time: 8419.994 ms
(8 rows)
</code></pre>
<h3 id="maintenance_work_mem">maintenance_work_mem</h3>
<p>指定维护操作使用的最大内存量，例如（Vacuum、Create Index和Alter Table Add Foreign Key），默认值是64MB。由于通常正常运行的数据库中不会有大量并发的此类操作，可以设置的较大一些，提高清理和创建索引外键的速度。</p>
<pre><code>postgres=# set maintenance_work_mem to &quot;64MB&quot;;
SET
Time: 1.971 ms
postgres=# create index idx1_test on test(id);
CREATE INDEX
Time: 7483.621 ms (00:07.484)
postgres=# set maintenance_work_mem to &quot;2GB&quot;;
SET
Time: 0.543 ms
postgres=# drop index idx1_test;
DROP INDEX
Time: 133.984 ms
postgres=# create index idx1_test on test(id);
CREATE INDEX
Time: 5661.018 ms (00:05.661)
</code></pre>
<p>可以看到在使用默认的64MB创建索引，速度为7.4秒，而设置为2GB后，创建速度是5.6秒</p>
<h3 id="wal_sync_method">wal_sync_method</h3>
<p>每次发生事务后，PostgreSQL会强制将提交写到WAL日志的方式。可以使用pg_test_fsync命令在你的操作系统上进行测试，fdatasync是Linux上的默认方法。如下所示，我的环境测试下来fdatasync还是速度可以的。不支持的方法像fsync_writethrough直接显示n/a。</p>
<pre><code>postgres=# show wal_sync_method ;
 wal_sync_method 
-----------------
 fdatasync
(1 row)

[pg@e22 ~]$ pg_test_fsync -s 3
3 seconds per test
O_DIRECT supported on this platform for open_datasync and open_sync.

Compare file sync methods using one 8kB write:
(in wal_sync_method preference order, except fdatasync is Linux's default)
        open_datasync                      4782.871 ops/sec     209 usecs/op
        fdatasync                          4935.556 ops/sec     203 usecs/op
        fsync                              3781.254 ops/sec     264 usecs/op
        fsync_writethrough                              n/a
        open_sync                          3850.219 ops/sec     260 usecs/op

Compare file sync methods using two 8kB writes:
(in wal_sync_method preference order, except fdatasync is Linux's default)
        open_datasync                      2469.646 ops/sec     405 usecs/op
        fdatasync                          4412.266 ops/sec     227 usecs/op
        fsync                              3432.794 ops/sec     291 usecs/op
        fsync_writethrough                              n/a
        open_sync                          1929.221 ops/sec     518 usecs/op

Compare open_sync with different write sizes:
(This is designed to compare the cost of writing 16kB in different write
open_sync sizes.)
         1 * 16kB open_sync write          3159.780 ops/sec     316 usecs/op
         2 *  8kB open_sync writes         1944.723 ops/sec     514 usecs/op
         4 *  4kB open_sync writes          993.173 ops/sec    1007 usecs/op
         8 *  2kB open_sync writes          493.396 ops/sec    2027 usecs/op
        16 *  1kB open_sync writes          249.762 ops/sec    4004 usecs/op

Test if fsync on non-write file descriptor is honored:
(If the times are similar, fsync() can sync data written on a different
descriptor.)
        write, fsync, close                3719.973 ops/sec     269 usecs/op
        write, close, fsync                3651.820 ops/sec     274 usecs/op

Non-sync'ed 8kB writes:
        write                            400577.329 ops/sec       2 usecs/op
</code></pre>
<h3 id="wal_buffers">wal_buffers</h3>
<p>事务日志缓冲区的大小，PostgreSQL将WAL记录写入缓冲区，然后再将缓冲区刷新到磁盘。在PostgreSQL 12版中，默认值为-1，也就是选择等于shared_buffers的1/32 。如果自动的选择太大或太小可以手工设置该值。一般考虑设置为16MB。</p>
<h3 id="synchronous_commit">synchronous_commit</h3>
<p>客户端执行提交，并且等待WAL写入磁盘之后，然后再将成功状态返回给客户端。可以设置为on，remote_apply，remote_write，local，off等值。默认设置为on。如果设置为off，会关闭sync_commit，客户端提交之后就立马返回，不用等记录刷新到磁盘。此时如果PostgreSQL实例崩溃，则最后几个异步提交将会丢失。</p>
<h3 id="default_statistics_target">default_statistics_target</h3>
<p>PostgreSQL使用统计信息来生成执行计划。统计信息可以通过手动Analyze命令或者是autovacuum进程启动的自动分析来收集，default_statistics_target参数指定在收集和记录这些统计信息时的详细程度。默认值为100对于大多数工作负载是比较合理的，对于非常简单的查询，较小的值可能会有用，而对于复杂的查询（尤其是针对大型表的查询），较大的值可能会更好。为了不要一刀切，可以使用ALTER TABLE .. ALTER COLUMN .. SET STATISTICS覆盖特定表列的默认收集统计信息的详细程度。</p>
<h3 id="checkpoint_timeoutmax_wal_sizemin_wal_sizecheckpoint_completion_target">checkpoint_timeout、max_wal_size，min_wal_size、checkpoint_completion_target</h3>
<p>了解这两个参数以前，首先我们来看一下，触发检查点的几个操作。</p>
<p>直接执行checkpoint命令 执行需要检查点的命令（例如pg_start_backup,Create database,pg_ctl stop/start等等） 自上一个检查点以来，达到了已经配置的时间量（checkpoint_timeout ） 自上一个检查点以来生成的WAL数量（max_wal_size） 使用默认值，检查点将在checkpoint_timeout=5min。也就是每5分钟触发一次。而max_wal_size设置是自动检查点之间增长的最大预写日志记录（WAL）量。默认是1GB，如果超过了1GB，则会发生检查点。这是一个软限制。在一个特殊的情况下，比如系统遭遇到短时间的高负载，日志产生几秒种就可以达到1GB，这个速度已经明显超过了checkpoint_timeout ，pg_wal目录的大小会急剧增加。此时我们可以从日志中看到相关类似的警告。</p>
<pre><code>LOG:  checkpoints are occurring too frequently (9 seconds apart)
HINT:  Consider increasing the configuration parameter &quot;max_wal_size&quot;.
LOG:  checkpoints are occurring too frequently (2 seconds apart)
HINT:  Consider increasing the configuration parameter &quot;max_wal_size&quot;.
</code></pre>
<p>所以要合理配置max_wal_size，以避免频繁的进行检查点。一般推荐设置为16GB以上，不过具体设置多大还需要和工作负荷相匹配。</p>
<p>min_wal_size参数是只要 WAL 磁盘使用量保持在这个设置之下，在做检查点时，旧的 WAL 文件总是被回收以便未来使用，而不是直接被删除。</p>
<p>而检查点的写入不是全部立马完成的，PostgreSQL会将一次检查点的所有操作分散到一段时间内。这段时间由参数checkpoint_completion_target控制，它是一个分数，默认为0.5。也就是在两次检查点之间的0.5比例完成写盘操作。如果设置的很小，则检查点进程就会更加迅速的写盘，设置的很大，则就会比较慢。一般推荐设置为0.9，让检查点的写入分散一点。但是缺点就是出现故障的时候，影响恢复的时间。</p>
<p>可以输入参数使用pgtune自动生成配置建议：https://pgtune.leopard.in.ua/#/</p>
<h2 id="_2">外部表</h2>
<h3 id="mysqlmariadbtidb">mysql/mariadb/tidb外部表</h3>
<pre><code class="language-sql">--举例中本地数据库用户为user
--创建fdw插件（如容器镜像pg13命令为apt-get update &amp;&amp; apt-get install -y postgresql-13-mysql-fdw)
create extension mysql_fdw;
--注册外部服务器
create server outdb foreign data wrapper mysql_fdw options (host '123.123.123.123' ,port '3306');
--在greenplum中，如果上面命令用pgadmin用户执行的话，需要将所有权给到普通用户
ALTER SERVER &quot;outdb&quot; OWNER TO &quot;user&quot;;
--创建用户映射
create user mapping for user server outdb options (username 'root',password 'password');
--创建外部表
CREATE FOREIGN TABLE &quot;public&quot;.&quot;out_yy_regions&quot; (
  &quot;indexCode&quot; varchar(255),
  &quot;name&quot; varchar(255),
  &quot;parentIndexCode&quot; varchar(255),
  &quot;treeCode&quot; varchar(255),
  &quot;id&quot; int4
)
SERVER &quot;outdb&quot;
OPTIONS (&quot;dbname&quot; 'mydb', &quot;table_name&quot; 'mytable');
</code></pre>
<h3 id="oracle">oracle外部表</h3>
<ul>
<li>todo</li>
</ul>
<h2 id="_3">物化视图</h2>
<blockquote>
<p>postgres中物化视图可以将需要一定计算量或者数据传输（例如外部表）耗时的视图仿真成为一个数据表，再辅以定时刷新或者按需刷新的机制来便捷的使用该数据；
</p>
</blockquote>
<h3 id="_4">创建物化视图</h3>
<pre><code class="language-sql">--假设存在一个外部表 out_tab1其中有100万数据，如果不做物化视图的话每次查询都会去原始数据库中拿这100万的数据，对于一些对耗时敏感的操作十分不友好，此时通过物化视图来进行优化；
--创建空的物化视图
create MATERIALIZED view mv_out_tab1 as select * from out_tab1 with no data;
--如果是greenplum还需要增加分布键的声明，例如：create MATERIALIZED view mv_out_tab1 as select * from out_tab1 with no data Distributed by (id)
--刷新数据
refresh MATERIALIZED view mv_out_tab1;
</code></pre>
<h2 id="_5">常用命令</h2>
<h3 id="_6">备份数据库或者结构</h3>
<pre><code class="language-bash">-- 备份表结构
pg_dump -h ${host} -p ${port} -d ${dbname} -U ${username} -s &gt; /data/${dbname}.sql

-- 只备份数据 -a ，只备份结构 -s，表结构和数据 什么都不加

-- 还原库
psql -h ${host} -p ${port} -U ${username} -d ${dbname} &lt; /data/${dbname}.sql

-- 备份指定表(包含数据)
pg_dump -h ${host} -p ${port} -d ${dbname} -t ${tablename1} -t ${tablename2}  -U ${username} &gt; /data/${filename}.sql

-- 导出导入数据到txt

copy ${tablename} to '/data/pgdata/csvbak/xxx.txt'

copy ${tablename} from '/data/pgdata/csvbak/xxx.txt'
</code></pre>
<h2 id="_7">常用技巧</h2>
<ul>
<li>domain 创建类型别名</li>
</ul>
<pre><code>create domain amount as decimal(33, 18);
create domain price as decimal(33, 18);
</code></pre>
<ul>
<li>自定义枚举类型 使用的时候可以传字符串，实际存储是整数。 create type 还可以创建其他更复杂的类型，这里就不详细介绍了。create type side as enum ('buy', 'sell');</li>
<li>Heap-Only-Tuple 和 fillfactor 这个和PG的MVCC实现有关系，简单的说，PG的表数据是存在无序的堆上的，包括主键的所有索引都是单独的，索引引用数据行在堆上的位置。 加上MVCC的实现，Update其实是Insert+Delete，新的行数据在堆上的位置发生改变，使得需要更新索引数据。为了优化这种情况， 如果在该条数据相同的Page上面有空闲位置，新插入数据优先放在相同页上，并和旧版本数据建立链表。在查询数据的时候，根据这个链表再去处理事务可见性等判断。 这样就不需要去更新索引数据了。如果Page上没有空闲位置就没办法了。所以 create table 的时候可以指定 fillfactor 选项，预先留出一些位置。 适合数据量不大且更新频繁的场景。</li>
<li>用snowflake算法生成唯一ID很实用，但是在PG上有个问题，PG遵循SQL标准，不支持无符号64位整数。snowflake留了41bit给毫秒级时间戳，去一位给符号位，剩下40位。 算一下发现2004年就溢出了，其实就算无符号64位整数，2039年也就溢出了。解决方案，时间戳统一减去一个最近的时间点，瞬间多出50年。 在PG里面用这种ID，结合自定义函数，连时间戳字段都省了(PG12貌似要支持虚拟字段了)。自动分表也可以按照ID进行，达到按时间戳分表一样的效果，还能保留主键功能，一举多得。</li>
<li>批量insert/update/upsert/delete/move</li>
</ul>
<pre><code class="language-sql">#数据库里面，批量操作的吞吐量和单条执行不在一个数量级。insert批量大家都知道：

insert into table values (1,3,3), (2,3,3), (3,3,3)...
#用psycopg2的朋友需要注意的是， cur.executemany 函数并不是真批量操作，他还是生成一堆独立的insert执行，真正的批量操作要这么写：
#postgresql批量操作
import time
import psycopg2
import psycopg2.extras
db=psycopg2.connect(&quot;dbname=postgres user=postgres password=pwd host=127.0.0.1&quot;)
cur=db.cursor()
#insert_values
lst=[]
for i in range(100_0000):
    lst.append(['name%s' % i,'text%s' % i])
cur.execute('truncate table ctest')
ta=time.time()
psycopg2.extras.execute_values(cur,&quot;&quot;&quot;
insert into ctest(uname,text) values %s&quot;&quot;&quot;,lst)
cur.execute(&quot;commit&quot;)
print('use time:%s' % (time.time()-ta))
# use time:15.339413166046143
cur.execute(&quot;select count(1) cnt from ctest&quot;)
data=cur.fetchone()
print(data)

db.close()
#update 如何批量呢：

with tmp(id, name) as (values (1, 'a'), (2, 'b'), (3, 'c'))
update table set name=tmp.name from tmp where table.id=tmp.id;
upsert:

insert into table values (1,3,3), (2,3,3), (3,3,3)...
on conflict (a) do update set a=table.a+excluded.a
delete:

delete from table where id = ANY[%s]
#move, 有时候我们想把数据批量从一个表移动到另一个表：

with moved_rows as (
  with tmp(id, a, b) as (values %s)
  delete from t_old_table a
  using tmp
  where tmp.id=a.id
  returning a.*
)
insert into t_new_table select * from moved_rows
</code></pre>
<ul>
<li>mvcc snapshot。问题：如何把一个并发访问的表一致的分割成多段，比如我们想要分批次对里面的数据进行处理，但不希望漏数据，也不希望重复处理。</li>
</ul>
<blockquote>
<p>注解 自增ID？在并发访问下，自增ID并不能保证连续没有间断的，比如中间可能还有事务没有提交。
</p>
<p>解决方案是，在表里保存 txid_current() ，要分段的时候，记录下 txid_current_snapshot() ，snapshot由三个信息组成：xmin, xmax, xip。 xmin是当前进行中的事务ID中最小的，也就是比xmin更小的事务都已提交或者撤销，xmax是下一个将要分配的事务ID，比xmax更大的事务还没出现，xip是当前进行中的事务ID列表。 那么一条记录是否发生在这个snapshot之前就很明确了， txid &lt; xmin or (txid &lt; xmax and txid not in xip) ，对应的函数是 txid_visible_in_snapshot(txid, snapshot) 。
</p>
</blockquote>
<ul>
<li>pipelinedb，流式聚合</li>
</ul>
<pre><code class="language-sql">create foreign table trade (time timestamp with time zone, price decimal, amount decimal) server pipelinedb;
create view kline_1m as select
    date_trunc('minute', time) as time,
    keyed_min(time, price) as open,
    max(price) as high,
    min(price) as low,
    keyed_max(time, price) as close,
    sum(amount) as volume,
    sum(amount * price) as value,
    count(*) as count
from trade group by 1;
create unique index kline_1m_time_idx on kline_1m(time);
然后只管疯狂对 trade 表insert， kline_1m 会自动更新聚合数据，而且 trade 不会保留数据。
</code></pre>
<ul>
<li>timescaledb，时序数据库，按照时间戳字段全自动分表。虽然pg有了声明式分表，但还是不如全自动来的爽。再也不用担心表数据量过太多影响性能了。</li>
</ul>
<h3 id="large-in">large in优化</h3>
<blockquote>
<p>Large In:查询条件中有例如 <code>id in (1,2,3……)</code> 很多很多值的list的情况，当传入值达到上万后效率很低。 常用方式：
</p>
</blockquote>
<ul>
<li>in-list：<code>where id in (1,2,3……)</code></li>
<li>常量子查询: <code>location in (values ('晨市'),('磊市'),('静市')) limit 100</code></li>
<li>临时表查询（cte）：</li>
</ul>
<pre><code class="language-sql">with tmp_ids as (
select unnest('{2100698,2100699,2100700,2100701,2100702,2100703,2100704,2100705,2100706,2100707,2100708,2100709,2100710,2100711,2100712,2100713,2100714,2100715,2100716}'::bigint[]) id
)
select * from czrkjbxx ck,tmp_ids tids where ck.pid =tids.id
</code></pre>
<ul>
<li>实测 ：1000个值差距不明显，在达到10000个值之后，IN-list需要18秒左右，常量子查询需要4秒，临时表只需要347 ms。临时表的效率是最高的。</li>
</ul>
<h3 id="cte">CTE语法</h3>
<pre><code class="language-sql">--#同行人粗略版
SELECT FLOOR
    ( EXTRACT ( epoch FROM pass_time ) ) :: int8 / 300 tick,
    pass_time,
    equipment_id 
FROM
    person_pass 
WHERE
    pass_time BETWEEN '2021-07-01 00:00:00' 
    AND '2021-07-09 23:59:59' 
GROUP BY
    FLOOR ( EXTRACT ( epoch FROM pass_time ) ) :: int8 / 300,
    pass_time,
    equipment_id 
    LIMIT 10000 
--交叠
    SELECT
    ta.NAME na,
    ta.idcard ia,
    tb.NAME nb,
    tb.idcard ib 
FROM
    ( SELECT * FROM person_pass WHERE equipment_id = '652823058706422' AND ( FLOOR ( EXTRACT ( epoch FROM pass_time ) ) :: int8 / 300 ) = 5418720 ) ta
    CROSS JOIN ( SELECT * FROM person_pass WHERE equipment_id = '652823058706422' AND ( FLOOR ( EXTRACT ( epoch FROM pass_time ) ) :: int8 / 300 ) = 5418720 ) tb 
WHERE
    ta.idcard != tb.idcard
</code></pre>
<h2 id="_8">锁处理</h2>
<pre><code class="language-sql">--查询当前连接信息
select * from pg_stat_activity
--查询锁信息
select * from gp_toolkit.gp_locks_on_relation
--查询排他锁
 select * from gp_toolkit.gp_locks_on_relation where lormode not like '%Share%'
--根据pid取消某个查询（pid来自于gp_locks_on_relation 中的lorpid字段）
select pg_cancel_backend(lorpid) from gp_toolkit.gp_locks_on_relation
--根据pid强制结束某个查询（pid来自于gp_locks_on_relation 中的lorpid字段）
select pg_terminate_backend(lorpid) from gp_toolkit.gp_locks_on_relation
--强制结束所有排他锁的查询
select pg_terminate_backend(lorpid) from gp_toolkit.gp_locks_on_relation where lormode not like '%Share%' and lorpid&lt;&gt;pg_backend_pid()
</code></pre>
<h2 id="pg">PG数据量限制</h2>
<pre><code class="language-sql">最大数据库大小无限制 

单个表最大大小 32 TB （对于block_size 8k，深层次原因是每个block都有个blocknumber，而blocknumber是个uint32类型）

最大行大小 1.6 TB 

最大字段大小 1 GB 

每张表的最大行数无限制 

每个表的最大列数 250 - 1600 取决于列类型 

每张表的最大索引数无限制
</code></pre>
<h2 id="_9">生成随机数据</h2>
<h3 id="_10">随机生成姓名</h3>
<pre><code class="language-sql">select RndName() from xxx limit 100 
</code></pre>
<pre><code class="language-sql">create function RndName() returns varchar(32) as 
$$
select concat((array['赵','钱','孙','李','周','吴','郑','王','冯','陈','褚','卫','蒋','沈','韩','杨','朱','秦','尤','许','何','吕','施','张','孔','曹','严','华','金','魏','陶','姜','戚','谢','邹','喻','柏','水','窦','章','云','苏','潘','葛','奚','范','彭','郎','鲁','韦','昌','马','苗','凤','花','方','俞','任','袁','柳','酆','鲍','史','唐','费','廉','岑','薛','雷','贺','倪','汤','滕','殷','罗','毕','郝','邬','安','常','乐','于','时','傅','皮','卞','齐','康','伍','余','元','卜','顾','孟','平','黄','和','穆','萧','尹','姚','邵','舒','汪','祁','毛','禹','狄','米','贝','明','臧','计','伏','成','戴','谈','宋','茅','庞','熊','纪','屈','项','祝','董','杜','阮','蓝','闵','席','季','麻','强','贾','路','娄','危','江','童','颜','郭','梅','盛','林','刁','钟','徐','邱','骆','高','夏','蔡','田','樊','胡','凌','霍','虞','万','支','柯','咎','管','卢','莫','经','房','裘','缪','干','解','应','宗','宣','丁','贲','邓','郁','单','杭','洪','包','诸','左','石','崔','吉','钮','龚','程','嵇','邢','滑','裴','陆','荣','翁','荀','羊','於','惠','甄','加','封','芮','羿','储','靳','汲','邴','糜','松','井','段','富','巫','乌','焦','巴','弓','牧','隗','山','谷','车','侯','宓','蓬','全','郗','班','仰','秋','仲','伊','宫','宁','仇','栾','暴','甘','钭','厉','戎','祖','武','符','刘','詹','束','龙','叶','幸','司','韶','郜','黎','蓟','薄','印','宿','白','怀','蒲','台','从','鄂','索','咸','籍','赖','卓','蔺','屠','蒙','池','乔','阴','胥','能','苍','双','闻','莘','党','翟','谭','贡','劳','逄','姬','申','扶','堵','冉','宰','郦','雍','璩','桑','桂','濮','牛','寿','通','边','扈','燕','冀','郏','浦','尚','农','温','别','庄','晏','柴','瞿','阎','充','慕','连','茹','习','宦','艾','鱼','容','向','古','易','慎','戈','廖','庚','终','暨','居','衡','步','都','耿','满','弘','匡','国','文','寇','广','禄','阙','东','殳','沃','利','蔚','越','夔','隆','师','巩','厍','聂','晁','勾','敖','融','冷','訾','辛','阚','那','简','饶','空','曾','毋','沙','乜','养','鞠','须','丰','巢','关','蒯','相','查','后','红','游','竺','权','逯','盖','益','桓','公','晋','楚','法','汝','鄢','涂','钦','缑','亢','况','有','商','牟','佘','佴','伯','赏','墨','哈','谯','笪','年','爱','阳','佟','琴','言','福'])[trunc(random()*426)+1],(array['烘','匀','彰','飘','宛','戚','褥','邦','煤','缔','慎','窖','爆','笔','柏','懂','孙','娃','潘','洛','阁','捆','怪','捶','变','轴','尤','貌','淮','哺','亏','剐','晤','疗','浅','痛','订','嘲','挥','耙','围','纸','钢','今','渡','冉','愤','绣','公','萧','调','尝','老','充','汝','你','炬','义','蓬','诫','搐','托','絮','账','枪','凑','囊','镶','检','波','承','商','兜','毕','踞','眼','贩','韵','伙','邮','挚','劳','赁','弘','乾','甭','晚','殴','蜗','通','颇','抛','樟','显','剧','唯','顽','侩','爸','瞬','锹','前','呜','施','踊','锅','湍','虏','刽','桑','浮','立','噎','朝','刃','请','卷','棘','连','杰','洽','绝','恼','泻','逻','币','毖','沁','秸','进','搞','横','蜒','敷','霓','榨','绞','土','鄂','猾','哮','缝','罐','三','披','分','潍','眩','皖','摩','茧','压','桓','姚','嚏','俩','固','蕉','宜','顺','忽','誊','陛','原','烽','崔','央','荔','铸','敲','饿','骋','龙','础','湃','柯','遥','慢','损','漆','撕','坑','芜','彻','嗓','庙','恫','待','乡','辨','唉','绑','径','魄','磅','起','妓','卢','梆','常','削','勘','切','黄','漾','七','狠','馏','块','阐','并','哥','佩','邑','仑','驳','膜','睦','硒','接','议','甜','厕','碑','深','阑','岔','虚','豪','驰','慈','莲','高','焉','赡','圣','巷','煌','咎','崖','鲤','蔚','澈','详','逞','颅','宙','诊','矩','壕','信','簧','粘','稼','秦','导','娇','震','帧','滴','阂','拦','设','重','妮','旁','腆','勉','奎','年','帮','榔','远','雪','盟','虫','忿','德','步','饲','柜','亡','敛','缄','迢','泪','神','誓','每','蛤','唐','翠','缅','占','它','割','鞭','饯','匙','蔗','漂','品','穿','咆','奠','亩','娶','西','本','误','噬','登','惦','镁','虎','魁','肆','池','狄','蹄','人','疥','结','讣','畔','廉','釜','操','孵','茸','愁','宝','臻','嫁','似','姨','墅','豺','垦','暇','瀑','涡','橇','乳','帖','沧','墩','斋','辛','配','彝','芒','内','槛','怨','抱','墓','燃','派','牙','向','挟','洋','邓','吠','诺','阅','乐','项','旬','羌','令','成','断','仪','息','甥','藏','拼','想','纷','刑','坝','腹','城','诀','周','帚','碰','舌','陋','祭','残','卤','碳','绚','赖','锁','愧','孩','终','铝','迎','蕊','氖','砸','身','稀','郝','叫','砰','域','肌','收','君','啡','缸','窟','揪','粪','小','讲','哭','蛀','跟','量','逗','薪','背','民','孺','营','版','蚂','折','摧','选','而','贫','惰','蔷','街','肚','纪','陈','桐','酗','渴','辜','滔','恍','吧','喂','抿','去','题','岩','蹭','谤','痉','懈','搀','官','佛','扒','舜','榆','螺','草','怯','睬','昆','栽','由','乞','五','硝','敌','皆','寸','捍','孟','图','汤','篷','弊','吱','录','坷','仓','刹','腰','搂','数','错','堤','硼','捞','播','苟','样','嘻','批','障','顶','论','窃','粳','与','丛','帆','句','裳','翼','炊','谦','狗','票','指','讥','雇','稽','壤','侥','颈','宰','僧','呀','环','忠','志','辙','亮','康','鹏','怕','绵','未','这','豢','讼','死','性','骏','绿','幸','诸','劲','替','匪','么','恐','写','卡','怖','哇','靴','署','褪','斩','涎','懦','段','琵','阵','番','河','廖','必','伐','换','雾','衫','盖','藉','廷','厌','霍','袋','香','短','凡','厩','珍','浆','秆','酒','孔','疆','淀','质','些','祁','权','胀','门','痒','练','宅','抖','盅','味','竖','蓄','打','郊','埠','胡','困','溺','饵','页','弛','腔','盛','亿','臣','技','颁','禹','屋','聪','黔','赏','狱','决','酬','辕','澎','傣','缨','愿','健','记','谁','仇','赛','翻','膀','掂','锐','悲','宫','姐','路','莹','胁','骇','危','鹅','惊','童','氮','拨','胰','梯','豹','惧','古','鬼','锭','除','钠','嵌','圾','第','侨','忱','秘','敝','祥','蛆','撼','匝','箍','奇','勤','蛛','驹','搅','媚','蘸','胯','工','瞻','赋','战','晴','兴','烤','伊','敦','线','驾','缎','率','役','徊','文','飞','傻','影','尸','饺','衬','马','富','歼','嘿','冶','寻','策','丽','鹊','斡','凌','学','幅','帽','刀','贵','旦','置','隧','蚊','瞳','磁','将','谍','沙','轿','挡','机','镐','摄','慕','链','延','屏','糯','云','泡','需','燕','命','研','撵','虾','羔','家','经','苯','遣','狡','祟','恰','矣','急','严','泅','弄','著','渣','娩','握','堪','景','治','郁','扦','芥','俯','史','曰','妙','盐','拄','涤','傲','硫','幌','岛','仗','监','艺','薄','咳','恤','坤','吸','隅','勒','韩','钎','盘','荒','献','况','勇','天','汇','在','形','粹','巴','痢','亥','燎','许','宠','痊','据','鸟','恃','拌','瓦','储','碧','攀','陪','猩','括','钵','冒','留','吩','缚','巩','钮','即','溪','六','汐','侠','蹋','仍','寞','碟','咐','葫','删','递','溢','扯','包','洒','眨','招','川','全','单','慑','夕','佃','楔','讽','刨','绷','逼','尺','渗','昼','霉','扶','鉴','附','颗','牵','谱','跨','雷','涸','赠','见','库','丢','玻','夹','墟','蝇','骡','定','澜','犁','杯','赶','委','蒙','啦','锨','钳','却','己','卞','凤','懒','抗','馁','挞','忧','蔬','袱','峦','采','净','榜','辩','烦','茂','锡','愉','贪','釉','闻','佣','棺','欣','浚','尿','膳','耗','沸','妻','哎','因','糖','象','痈','醛','懊','吓','坟','端','渤','溅','锤','膏','驭','逊','躲','仁','混','嘉','掸','篓','亚','嘱','皇','榷','枣','军','脸','盗','佳','案','班','尔','冤','脐','胜','憋','肄','边','谐','萍','境','拍','于','守','截','鸥','父','烩','肛','摊','敖','栅','音','犯','咒','从','疾','秉','盾','吊','籍','让','酮','予','缆','慰','慨','简','骸','恩','硬','嚣','范','燥','恳'])[floor(random()*998)+1],(array['烘','匀','彰','飘','宛','戚','褥','邦','煤','缔','慎','窖','爆','笔','柏','懂','孙','娃','潘','洛','阁','捆','怪','捶','变','轴','尤','貌','淮','哺','亏','剐','晤','疗','浅','痛','订','嘲','挥','耙','围','纸','钢','今','渡','冉','愤','绣','公','萧','调','尝','老','充','汝','你','炬','义','蓬','诫','搐','托','絮','账','枪','凑','囊','镶','检','波','承','商','兜','毕','踞','眼','贩','韵','伙','邮','挚','劳','赁','弘','乾','甭','晚','殴','蜗','通','颇','抛','樟','显','剧','唯','顽','侩','爸','瞬','锹','前','呜','施','踊','锅','湍','虏','刽','桑','浮','立','噎','朝','刃','请','卷','棘','连','杰','洽','绝','恼','泻','逻','币','毖','沁','秸','进','搞','横','蜒','敷','霓','榨','绞','土','鄂','猾','哮','缝','罐','三','披','分','潍','眩','皖','摩','茧','压','桓','姚','嚏','俩','固','蕉','宜','顺','忽','誊','陛','原','烽','崔','央','荔','铸','敲','饿','骋','龙','础','湃','柯','遥','慢','损','漆','撕','坑','芜','彻','嗓','庙','恫','待','乡','辨','唉','绑','径','魄','磅','起','妓','卢','梆','常','削','勘','切','黄','漾','七','狠','馏','块','阐','并','哥','佩','邑','仑','驳','膜','睦','硒','接','议','甜','厕','碑','深','阑','岔','虚','豪','驰','慈','莲','高','焉','赡','圣','巷','煌','咎','崖','鲤','蔚','澈','详','逞','颅','宙','诊','矩','壕','信','簧','粘','稼','秦','导','娇','震','帧','滴','阂','拦','设','重','妮','旁','腆','勉','奎','年','帮','榔','远','雪','盟','虫','忿','德','步','饲','柜','亡','敛','缄','迢','泪','神','誓','每','蛤','唐','翠','缅','占','它','割','鞭','饯','匙','蔗','漂','品','穿','咆','奠','亩','娶','西','本','误','噬','登','惦','镁','虎','魁','肆','池','狄','蹄','人','疥','结','讣','畔','廉','釜','操','孵','茸','愁','宝','臻','嫁','似','姨','墅','豺','垦','暇','瀑','涡','橇','乳','帖','沧','墩','斋','辛','配','彝','芒','内','槛','怨','抱','墓','燃','派','牙','向','挟','洋','邓','吠','诺','阅','乐','项','旬','羌','令','成','断','仪','息','甥','藏','拼','想','纷','刑','坝','腹','城','诀','周','帚','碰','舌','陋','祭','残','卤','碳','绚','赖','锁','愧','孩','终','铝','迎','蕊','氖','砸','身','稀','郝','叫','砰','域','肌','收','君','啡','缸','窟','揪','粪','小','讲','哭','蛀','跟','量','逗','薪','背','民','孺','营','版','蚂','折','摧','选','而','贫','惰','蔷','街','肚','纪','陈','桐','酗','渴','辜','滔','恍','吧','喂','抿','去','题','岩','蹭','谤','痉','懈','搀','官','佛','扒','舜','榆','螺','草','怯','睬','昆','栽','由','乞','五','硝','敌','皆','寸','捍','孟','图','汤','篷','弊','吱','录','坷','仓','刹','腰','搂','数','错','堤','硼','捞','播','苟','样','嘻','批','障','顶','论','窃','粳','与','丛','帆','句','裳','翼','炊','谦','狗','票','指','讥','雇','稽','壤','侥','颈','宰','僧','呀','环','忠','志','辙','亮','康','鹏','怕','绵','未','这','豢','讼','死','性','骏','绿','幸','诸','劲','替','匪','么','恐','写','卡','怖','哇','靴','署','褪','斩','涎','懦','段','琵','阵','番','河','廖','必','伐','换','雾','衫','盖','藉','廷','厌','霍','袋','香','短','凡','厩','珍','浆','秆','酒','孔','疆','淀','质','些','祁','权','胀','门','痒','练','宅','抖','盅','味','竖','蓄','打','郊','埠','胡','困','溺','饵','页','弛','腔','盛','亿','臣','技','颁','禹','屋','聪','黔','赏','狱','决','酬','辕','澎','傣','缨','愿','健','记','谁','仇','赛','翻','膀','掂','锐','悲','宫','姐','路','莹','胁','骇','危','鹅','惊','童','氮','拨','胰','梯','豹','惧','古','鬼','锭','除','钠','嵌','圾','第','侨','忱','秘','敝','祥','蛆','撼','匝','箍','奇','勤','蛛','驹','搅','媚','蘸','胯','工','瞻','赋','战','晴','兴','烤','伊','敦','线','驾','缎','率','役','徊','文','飞','傻','影','尸','饺','衬','马','富','歼','嘿','冶','寻','策','丽','鹊','斡','凌','学','幅','帽','刀','贵','旦','置','隧','蚊','瞳','磁','将','谍','沙','轿','挡','机','镐','摄','慕','链','延','屏','糯','云','泡','需','燕','命','研','撵','虾','羔','家','经','苯','遣','狡','祟','恰','矣','急','严','泅','弄','著','渣','娩','握','堪','景','治','郁','扦','芥','俯','史','曰','妙','盐','拄','涤','傲','硫','幌','岛','仗','监','艺','薄','咳','恤','坤','吸','隅','勒','韩','钎','盘','荒','献','况','勇','天','汇','在','形','粹','巴','痢','亥','燎','许','宠','痊','据','鸟','恃','拌','瓦','储','碧','攀','陪','猩','括','钵','冒','留','吩','缚','巩','钮','即','溪','六','汐','侠','蹋','仍','寞','碟','咐','葫','删','递','溢','扯','包','洒','眨','招','川','全','单','慑','夕','佃','楔','讽','刨','绷','逼','尺','渗','昼','霉','扶','鉴','附','颗','牵','谱','跨','雷','涸','赠','见','库','丢','玻','夹','墟','蝇','骡','定','澜','犁','杯','赶','委','蒙','啦','锨','钳','却','己','卞','凤','懒','抗','馁','挞','忧','蔬','袱','峦','采','净','榜','辩','烦','茂','锡','愉','贪','釉','闻','佣','棺','欣','浚','尿','膳','耗','沸','妻','哎','因','糖','象','痈','醛','懊','吓','坟','端','渤','溅','锤','膏','驭','逊','躲','仁','混','嘉','掸','篓','亚','嘱','皇','榷','枣','军','脸','盗','佳','案','班','尔','冤','脐','胜','憋','肄','边','谐','萍','境','拍','于','守','截','鸥','父','烩','肛','摊','敖','栅','音','犯','咒','从','疾','秉','盾','吊','籍','让','酮','予','缆','慰','慨','简','骸','恩','硬','嚣','范','燥','恳'])[floor(random()*2000)+1]);
$$ language sql
</code></pre>
<h3 id="_11">随机生成身份证号码</h3>
<pre><code class="language-sql">select RndIdcard() 
</code></pre>
<pre><code class="language-sql">create or replace function RndIdcard() returns varchar(18) as 
$$
select concat(floor(random()*(500000-777799)+999999),to_char(now()::timestamp - random() * interval '10 year','YYYYMMDD'),floor(random()*(10-99)+99),floor(random()*2),floor(random()*9))
$$ language sql

</code></pre>
<h3 id="_12">随机生成手机号</h3>
<pre><code class="language-sql">create or replace function RndPhone() returns varchar(18) as 
$$
select to_char(floor(random()*(13000000000-13999999999)+13999999999),'00000000000')
$$ language sql

</code></pre>
<h3 id="_13">随机生成日期时间</h3>
<pre><code class="language-pgsql">create or replace function RndDatetime() returns TIMESTAMP as 
$$
select now()::timestamp - random() * interval '3 month'
$$ language sql

</code></pre>
<h3 id="id">随机生成设备id</h3>
<pre><code class="language-pgsql">create or replace function RndDevid() returns varchar(32) as 
$$
select concat('DEV-',floor(random()*(300000-700000)+700000),floor(random()*(1000000-7000000)+7000000))
$$ language sql
</code></pre>
<h3 id="_14">建立列存表</h3>
<pre><code class="language-pgsql">create table demo_person_pass (id serial8,name varchar(32),idcard varchar(32),phone varchar(16),equipment_id varchar(32),pass_time timestamptz) with(appendonly=true,orientation=column) distributed by (id) ;
</code></pre>
<h3 id="_15">写入测试数据</h3>
<pre><code class="language-pgsql">insert into demo_person_pass(name,idcard,phone,equipment_id,pass_time) SELECT
    RndName ( ) NAME,
    RndIdcard ( ) idcard,
    RndPhone ( ) phone,
    RndDevid() equipment_id,
    RndDatetime ( ) pass_time 
FROM
    user_log 
    LIMIT 1000
</code></pre>
<h2 id="_16">创建用户</h2>
<pre><code class="language-pgsql">create user zyzs with password 'pwd';
grant all privileges on database zyzsdag to zyzs;
\c dbname
grant all privileges on all tables in schema public to zyzs;
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
