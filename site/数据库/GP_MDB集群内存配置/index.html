<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://wiki.xlz2021.cf/%E6%95%B0%E6%8D%AE%E5%BA%93/GP_MDB%E9%9B%86%E7%BE%A4%E5%86%85%E5%AD%98%E9%85%8D%E7%BD%AE/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>gp/mdb集群内存配置 - 玄凌子知识库</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/java.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/languages/kotlin.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">玄凌子知识库</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">关于我</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Java <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Java/JPA%E5%88%86%E9%A1%B5%E6%9C%80%E5%A4%A7%E6%9D%A1%E6%95%B0%E9%99%90%E5%88%B6%E4%BF%AE%E6%94%B9/" class="dropdown-item">JPA分页最大条数限制修改</a>
</li>
                                    
<li>
    <a href="../../Java/Maven/" class="dropdown-item">Maven 使用</a>
</li>
                                    
<li>
    <a href="../../Java/github%E8%AE%BF%E9%97%AE/" class="dropdown-item">Github访问</a>
</li>
                                    
<li>
    <a href="../../Java/gradle%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84/" class="dropdown-item">Gradle自定义存储路径</a>
</li>
                                    
<li>
    <a href="../../Java/logback%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF/" class="dropdown-item">Logback配置模板</a>
</li>
                                    
<li>
    <a href="../../Java/mvn%E6%89%A7%E8%A1%8C%E6%B7%B7%E7%94%A8jdk8%E5%92%8C11/" class="dropdown-item">Mvn执行混用jdk8和11</a>
</li>
                                    
<li>
    <a href="../../Java/openjdk%E6%97%A0%E6%B3%95%E7%94%9F%E6%88%90%E9%AA%8C%E8%AF%81%E7%A0%81%E8%A7%A3%E5%86%B3/" class="dropdown-item">基于alpine的openjdk8无法生成验证码的解决</a>
</li>
                                    
<li>
    <a href="../../Java/%E4%BF%9D%E7%95%99%E7%AB%AF%E5%8F%A3%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98/" class="dropdown-item">保留端口占用问题</a>
</li>
                                    
<li>
    <a href="../../Java/%E6%97%A5%E6%9C%9F%E6%A0%BC%E5%BC%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" class="dropdown-item">YYYY和yyyy的区别</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Python <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Python/JupyterNotebook%E5%AE%89%E8%A3%85/" class="dropdown-item">Jupyter Notebook 安装</a>
</li>
                                    
<li>
    <a href="../../Python/pypi%E6%BA%90/" class="dropdown-item">Pypi源</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99%E6%9C%AF/" class="dropdown-item">图片隐写术</a>
</li>
                                    
<li>
    <a href="../../Python/%E5%AE%89%E8%A3%85ta-lib/" class="dropdown-item">安装ta lib</a>
</li>
                                    
<li>
    <a href="../../Python/%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7/" class="dropdown-item">打包工具</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Docker <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../docker/Centos%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85docker/" class="dropdown-item">Centos在线安装docker</a>
</li>
                                    
<li>
    <a href="../../docker/K3S%E5%AE%89%E8%A3%85/" class="dropdown-item">K3S安装</a>
</li>
                                    
<li>
    <a href="../../docker/Linux%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85docker/" class="dropdown-item">Linux在线安装docker</a>
</li>
                                    
<li>
    <a href="../../docker/Pg14%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA/" class="dropdown-item">Pg14生产环境镜像构建</a>
</li>
                                    
<li>
    <a href="../../docker/Swarm%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" class="dropdown-item">Swarm集群使用说明</a>
</li>
                                    
<li>
    <a href="../../docker/debian%E6%9B%B4%E6%96%B0source/" class="dropdown-item">debian容器更新source.list</a>
</li>
                                    
<li>
    <a href="../../docker/docker%E5%AE%B9%E5%99%A8%E5%87%BA%E7%8E%B0%E6%93%8D%E4%BD%9C%E4%B8%8D%E5%85%81%E8%AE%B8%E9%94%99%E8%AF%AF/" class="dropdown-item">Docker容器出现操作不允许错误</a>
</li>
                                    
<li>
    <a href="../../docker/docker%E5%AE%B9%E5%99%A8%E7%9B%B8%E5%85%B3/" class="dropdown-item">docker容器相关</a>
</li>
                                    
<li>
    <a href="../../docker/seaweedfs%E4%BD%9C%E4%B8%BA%E5%88%86%E5%B8%83%E5%BC%8F%E5%AD%98%E5%82%A8%E6%8F%92%E4%BB%B6/" class="dropdown-item">Seaweedfs作为分布式存储插件</a>
</li>
                                    
<li>
    <a href="../../docker/wsl2%E6%A1%A5%E6%8E%A5/" class="dropdown-item">Wsl2桥接</a>
</li>
                                    
<li>
    <a href="../../docker/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84nfs%E6%9C%8D%E5%8A%A1/" class="dropdown-item">基于容器的nfs服务</a>
</li>
                                    
<li>
    <a href="../../docker/%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" class="dropdown-item">容器使用注意事项</a>
</li>
                                    
<li>
    <a href="../../docker/%E7%A6%81%E6%AD%A2%E5%AE%B9%E5%99%A8%E8%AE%BF%E9%97%AE%E5%A4%96%E7%BD%91/" class="dropdown-item">禁止容器访问外网</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Linux <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../linux/Alpine%E4%BD%BF%E7%94%A8%E6%B8%85%E5%8D%8E%E6%BA%90/" class="dropdown-item">Alpine使用清华源</a>
</li>
                                    
<li>
    <a href="../../linux/CentOS%E5%AE%8C%E7%BE%8E%E5%8D%87%E7%BA%A7gcc%E7%89%88%E6%9C%AC%E6%96%B9%E6%B3%95/" class="dropdown-item">CentOS完美升级gcc版本方法</a>
</li>
                                    
<li>
    <a href="../../linux/Centos7%E6%9B%B4%E6%96%B0%E5%86%85%E6%A0%B8/" class="dropdown-item">Centos7更新内核</a>
</li>
                                    
<li>
    <a href="../../linux/Centos7%E6%9B%B4%E6%96%B0%E8%87%AA%E5%B8%A6%E7%9A%84openssh%E4%BF%AE%E5%A4%8D%E6%BC%8F%E6%B4%9E/" class="dropdown-item">Centos7更新openssh修复漏洞</a>
</li>
                                    
<li>
    <a href="../../linux/FIO%E6%B5%8B%E8%AF%95%E7%A3%81%E7%9B%98IO/" class="dropdown-item">FIO测试磁盘IO</a>
</li>
                                    
<li>
    <a href="../../linux/Linux_LVM%E5%88%86%E5%8C%BA%E6%89%A9%E5%AE%B9/" class="dropdown-item">LVM分区扩容</a>
</li>
                                    
<li>
    <a href="../../linux/Nginx%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/" class="dropdown-item">Nginx配置说明</a>
</li>
                                    
<li>
    <a href="../../linux/centos7_selinux/" class="dropdown-item">修复Centos7的SELINUX错误</a>
</li>
                                    
<li>
    <a href="../../linux/centos7%E5%8D%95%E7%94%A8%E6%88%B7%E6%A8%A1%E5%BC%8F/" class="dropdown-item">Centos7单用户模式</a>
</li>
                                    
<li>
    <a href="../../linux/centos_update_gcc/" class="dropdown-item">CentOS完美升级gcc版本方法</a>
</li>
                                    
<li>
    <a href="../../linux/cron/" class="dropdown-item">cron定时任务常见问题</a>
</li>
                                    
<li>
    <a href="../../linux/cron%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="dropdown-item">Cron定时任务常见问题</a>
</li>
                                    
<li>
    <a href="../../linux/cron%E9%98%B2%E6%AD%A2%E9%87%8D%E5%A4%8D%E6%89%A7%E8%A1%8C/" class="dropdown-item">cron防止重复执行</a>
</li>
                                    
<li>
    <a href="../../linux/iperf3%E5%B8%A6%E5%AE%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">Iperf3带宽测试</a>
</li>
                                    
<li>
    <a href="../../linux/n2n/" class="dropdown-item">服务节点</a>
</li>
                                    
<li>
    <a href="../../linux/net_safe/" class="dropdown-item">网络安全防护</a>
</li>
                                    
<li>
    <a href="../../linux/net_speed_test/" class="dropdown-item">带宽测试</a>
</li>
                                    
<li>
    <a href="../../linux/nfs%E6%90%AD%E5%BB%BA%E4%B8%8E%E4%BD%BF%E7%94%A8/" class="dropdown-item">nfs搭建与使用</a>
</li>
                                    
<li>
    <a href="../../linux/nginx/" class="dropdown-item">nginx负载均衡</a>
</li>
                                    
<li>
    <a href="../../linux/tcpdump%E6%8A%93%E5%8C%85/" class="dropdown-item">tcpdump抓包</a>
</li>
                                    
<li>
    <a href="../../linux/update_centos7_kernel/" class="dropdown-item">Centos7 升级内核版本</a>
</li>
                                    
<li>
    <a href="../../linux/%E4%BF%AE%E5%A4%8DCentos7%E7%9A%84SELINUX%E9%94%99%E8%AF%AF/" class="dropdown-item">修复Centos7的SELINUX错误</a>
</li>
                                    
<li>
    <a href="../../linux/%E5%90%84%E9%A1%B9%E6%80%A7%E8%83%BD%E5%8F%82%E6%95%B0%E7%9B%91%E6%B5%8B/" class="dropdown-item">性能参数监测</a>
</li>
                                    
<li>
    <a href="../../linux/%E5%9C%A8linux%E9%80%9A%E8%BF%87docker%E8%BF%90%E8%A1%8C%E5%BE%AE%E4%BF%A1/" class="dropdown-item">在linux通过docker运行微信</a>
</li>
                                    
<li>
    <a href="../../linux/%E6%96%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE/" class="dropdown-item">新服务器基本配置流程</a>
</li>
                                    
<li>
    <a href="../../linux/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4/" class="dropdown-item">网络安全防护</a>
</li>
                                    
<li>
    <a href="../../linux/%E9%92%88%E5%AF%B9%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%BB%84%E4%BB%B6%E7%9A%84NFS%E6%8C%82%E8%BD%BD%E5%8F%82%E6%95%B0/" class="dropdown-item">针对大数据组件的NFS挂载参数</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Store <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../store/seaweedfs/" class="dropdown-item">Seaweedfs</a>
</li>
                                    
<li>
    <a href="../../store/%E5%90%8C%E7%A8%8B%E6%97%85%E8%A1%8Cseaweedfs%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="dropdown-item">同程旅行Seaweedfs最佳实践</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">中医 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E4%BA%94%E6%AD%A5%E5%AD%A6%E7%BA%AF%E6%AD%A3%E4%B8%AD%E5%8C%BB/" class="dropdown-item">倪海厦｜跟着这五个步骤学好纯正中医</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E5%A4%A7%E5%8C%BB%E7%B2%BE%E8%AF%9A/" class="dropdown-item">大医精诚</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%84%9F%E5%86%92%E7%BB%8F%E6%96%B9%E9%80%89%E8%8D%AF%E5%9B%BE/" class="dropdown-item">感冒经方选药图</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%9C%AC%E8%8D%89/" class="dropdown-item">本草笔记</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E6%B1%A4%E6%B6%B2%E7%BB%8F%E6%B3%95/" class="dropdown-item">汤液经法</a>
</li>
                                    
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E8%8D%AF%E9%A3%9F%E5%90%8C%E6%BA%90%E7%9B%AE%E5%BD%952023/" class="dropdown-item">药食同源目录2023</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">灵枢</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E4%B8%AD%E5%8C%BB%E5%9F%BA%E7%A1%80/" class="dropdown-item">中医基础</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="dropdown-item">人纪针灸学习笔记</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B0%8F%E5%84%BF%E4%B8%80%E8%88%AC%E6%84%9F%E5%86%92%E9%87%8D%E6%84%9F%E5%86%92%E7%A7%AF%E9%A3%9F%E7%9A%84%E6%8E%A8%E6%8B%BF%E6%89%8B%E6%B3%95/" class="dropdown-item">**小儿一般感冒重感冒积食的推拿手法**</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B8%B8%E7%94%A8%E5%85%BB%E7%94%9F%E7%A9%B4%E4%BD%8D/" class="dropdown-item">常用养生穴位</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E5%B8%B8%E8%A7%81%E7%97%85%E7%A9%B4%E4%BD%8D%E7%96%97%E6%B3%95/" class="dropdown-item">常见病穴位疗法</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E7%83%A7%E5%B1%B1%E7%81%AB%E4%B8%8E%E9%80%8F%E5%A4%A9%E5%87%89%E6%89%8B%E6%B3%95/" class="dropdown-item">烧山火与透天凉手法</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E7%BB%8F%E7%BB%9C%E5%B9%B2%E6%94%AF/" class="dropdown-item">经络天干</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E9%AB%98%E8%A1%80%E5%8E%8B%E8%BE%A8%E8%AF%81%E4%B8%8E%E6%96%B9%E9%92%88/" class="dropdown-item">高血压辨证与方针</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%81%B5%E6%9E%A2/%E9%BA%A6%E7%B2%92%E8%82%BF%E8%BE%A9%E8%AF%81%E4%B8%8E%E6%96%B9%E9%92%88/" class="dropdown-item">麦粒肿辩证与方针</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">素问</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E5%B8%B8%E7%94%A8%E6%96%B9%E5%89%82/" class="dropdown-item">常用方剂</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%95%91%E5%91%BD%E7%A8%BB%E8%8D%89/" class="dropdown-item">救命稻草</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%96%B0%E6%96%87%E6%A1%A3/" class="dropdown-item">新文档</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E6%B1%A4%E5%A4%B4%E6%AD%8C%E8%AF%80/" class="dropdown-item">汤头歌诀</a>
</li>
            
<li>
    <a href="../../%E4%B8%AD%E5%8C%BB/%E7%B4%A0%E9%97%AE/%E9%BB%84%E5%B8%9D%E5%86%85%E7%BB%8F_%E5%85%BB%E7%94%9F/" class="dropdown-item">黄帝内经_养生</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">人工智能 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E5%B8%B8%E8%A7%81%E7%AE%97%E6%B3%95%E4%BC%98%E7%BC%BA%E7%82%B9/" class="dropdown-item">常见算法优缺点</a>
</li>
                                    
<li>
    <a href="../../%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B%E5%8E%9F%E7%90%86/" class="dropdown-item">语言模型原理</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">修行 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E4%BB%99%E4%BC%A0%E7%8E%84%E6%9C%BA%E5%8F%A3%E8%AF%80/" class="dropdown-item">仙传玄机口诀</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E4%BF%AE%E8%A1%8C%E5%87%BA%E5%81%8F/" class="dropdown-item">修行出偏</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E4%B8%8B%E6%89%8B%E5%90%8E%E6%AC%B2%E6%9C%9B%E5%BC%BA%E7%83%88%E7%9A%84%E9%97%AE%E9%A2%98/" class="dropdown-item">关于丹道下手后欲望强烈的问题</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E5%88%9D%E5%AD%A6%E8%80%85%E4%B8%8B%E6%89%8B%E5%AE%9E%E4%BF%AE%E5%8A%9F%E5%A4%AB/" class="dropdown-item">关于丹道初学者下手实修功夫</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%85%B3%E4%BA%8E%E4%B8%B9%E9%81%93%E6%B2%BB%E7%97%85/" class="dropdown-item">关于丹道治病</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E5%A5%B3%E7%94%9F%E6%83%B3%E8%A6%81%E4%BF%AE%E9%81%93%E8%A6%81%E6%80%8E%E4%B9%88%E5%81%9A/" class="dropdown-item">女生修道怎么做-两篇</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%96%B0%E4%BA%BA%E4%B8%B9%E9%81%93%E9%81%BF%E5%9D%91/" class="dropdown-item">新人丹道避坑</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%9C%89%E4%BA%BA%E8%AF%B4%E4%B8%B9%E9%81%93%E7%81%AB%E5%80%99%E4%B8%8D%E8%83%BD%E9%9D%A0%E8%87%AA%E5%B7%B1%E6%8F%A3%E6%91%A9%EF%BC%8C%E5%8F%AA%E8%83%BD%E9%9D%A0%E5%B8%88%E6%89%BF%E5%8F%A3%E8%AF%80%E3%80%82%E9%82%A3%E4%B9%88%EF%BC%8C%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9A%84%E5%8A%9F%E6%B3%95%E6%98%AF%E5%A6%82%E4%BD%95%E5%87%BA%E7%8E%B0%E7%9A%84/" class="dropdown-item">有人说丹道火候不能靠自己揣摩，只能靠师承口诀。那么，最开始的功法是如何出现的</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E6%B8%85%E9%9D%99%E7%BB%8F/" class="dropdown-item">清静经</a>
</li>
                                    
<li>
    <a href="../../%E4%BF%AE%E8%A1%8C/%E7%A5%9E%E6%A3%8D%E7%90%86%E8%AE%BA/" class="dropdown-item">神棍理论</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">前端 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E5%89%8D%E7%AB%AF/node_sass/" class="dropdown-item">Node sass</a>
</li>
                                    
<li>
    <a href="../../%E5%89%8D%E7%AB%AF/nodejs%E7%8E%AF%E5%A2%83/" class="dropdown-item">Nodejs环境</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">大数据 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ES%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="dropdown-item">ES性能指标</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch/" class="dropdown-item">ElasticSearch技巧</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E4%BD%BF%E7%94%A8/" class="dropdown-item">Elasticsearch使用</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E5%A4%A7%E7%89%88%E6%9C%AC%E5%8D%87%E7%BA%A7/" class="dropdown-item">大版本升级方案</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/ElasticSearch%E6%8A%80%E5%B7%A7/" class="dropdown-item">ElasticSearch技巧</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink_sql_ETL%E9%9B%86%E5%90%88/" class="dropdown-item">Flink-sql-ETL集合</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Flink%E5%B8%B8%E7%94%A8%E8%BF%9E%E6%8E%A5%E5%99%A8%E8%AF%BB%E5%86%99%E8%83%BD%E5%8A%9B%E6%B1%87%E6%80%BB/" class="dropdown-item">Flink常用connector支持情况</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/GP%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%E9%A1%B9/" class="dropdown-item">GP常用配置项</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Greenplum%E7%A7%BB%E9%99%A4Segment/" class="dropdown-item">Greenplum移除Segment</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E7%9B%B8%E5%85%B3/" class="dropdown-item">Kafka相关</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E7%B3%BB%E7%BB%9F%E8%B0%83%E4%BC%98%E6%B5%8B%E8%AF%95/" class="dropdown-item">kafka调优</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/Kafka%E8%B0%83%E4%BC%98%E7%9B%B8%E5%85%B3/" class="dropdown-item">Kafka调优相关</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/cdh_spark/" class="dropdown-item">cdh编写spark依赖问题</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flinksql%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0%E8%AE%BE%E7%BD%AE/" class="dropdown-item">Flinksql常用参数设置</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flink%E9%85%8D%E7%BD%AE%E8%B0%83%E4%BC%98/" class="dropdown-item">flink 配置调优</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/flink%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">flink集群搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/gp6%E5%BA%93%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">Gp6库性能测试</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/greenplum%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8/" class="dropdown-item">greenplum集群使用</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/greenplum%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">greenplum集群搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/kafka%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/" class="dropdown-item">kafka性能测试</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/mysql/" class="dropdown-item">Mysql</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8EDinky%E7%9A%84cdc%E6%95%B4%E5%BA%93%E5%90%8C%E6%AD%A5/" class="dropdown-item">基于Dinky的cdc整库同步</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84dinky_flink_kafka/" class="dropdown-item">基于容器的dinky和flink以及kafka</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84pyflink/" class="dropdown-item">使用基于容器的pyflink</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E5%B8%A6%E5%AF%86%E7%A0%81%E7%9A%84kafka%E9%83%A8%E7%BD%B2/" class="dropdown-item">带用户密码的kafka搭建</a>
</li>
                                    
<li>
    <a href="../../%E5%A4%A7%E6%95%B0%E6%8D%AE/%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83kafka%E9%85%8D%E7%BD%AE/" class="dropdown-item">生产环境kafka配置说明</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">数据库 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../Arm64%E7%89%88%E6%9C%ACCitus%E8%AF%B4%E6%98%8E/" class="dropdown-item">初始化数据库</a>
</li>
                                    
<li>
    <a href="../Citus%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8/" class="dropdown-item">Citus集群使用</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">gp/mdb集群内存配置</a>
</li>
                                    
<li>
    <a href="../Lcpg%E5%86%85%E9%83%A8%E5%8F%91%E8%A1%8C%E7%89%88%E4%BD%BF%E7%94%A8/" class="dropdown-item">Lcpg内部发行版使用</a>
</li>
                                    
<li>
    <a href="../Mariadb%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/" class="dropdown-item">Mariadb主从复制</a>
</li>
                                    
<li>
    <a href="../Mariadb%E5%A4%9A%E4%B8%BB%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA/" class="dropdown-item">Mariadb多主集群搭建</a>
</li>
                                    
<li>
    <a href="../Mysql%E6%95%85%E9%9A%9C%E6%81%A2%E5%A4%8D/" class="dropdown-item">mysql故障恢复</a>
</li>
                                    
<li>
    <a href="../Neo4j%E7%9B%B8%E5%85%B3/" class="dropdown-item">Neo4j相关</a>
</li>
                                    
<li>
    <a href="../Pg%E5%8E%9F%E7%94%9F%E9%9B%86%E7%BE%A4%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E4%B8%8E%E9%AB%98%E5%8F%AF%E7%94%A8/" class="dropdown-item">PG原生集群复制配置与高可用</a>
</li>
                                    
<li>
    <a href="../Postgresql/" class="dropdown-item">Postgresql相关</a>
</li>
                                    
<li>
    <a href="../Postgresql%E7%9B%B8%E5%85%B3/" class="dropdown-item">Postgresql相关</a>
</li>
                                    
<li>
    <a href="../Postgresql%E9%9B%86%E7%BE%A4/" class="dropdown-item">pg集群搭建</a>
</li>
                                    
<li>
    <a href="../Redis%E4%BD%BF%E7%94%A8%E7%9B%B8%E5%85%B3/" class="dropdown-item">Redis相关</a>
</li>
                                    
<li>
    <a href="../Redis%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3/" class="dropdown-item">Redis集群相关</a>
</li>
                                    
<li>
    <a href="../gp_mdb%E7%A1%AC%E4%BB%B6%E9%80%89%E5%9E%8B%E8%AE%A1%E5%88%92/" class="dropdown-item">gp与mdb硬件选型计划</a>
</li>
                                    
<li>
    <a href="../mysql_mariadb/" class="dropdown-item">mysql/mariadb</a>
</li>
                                    
<li>
    <a href="../mysql%E5%88%A0%E9%99%A4%E5%A4%A7%E8%A1%A8/" class="dropdown-item">mysql删除大表</a>
</li>
                                    
<li>
    <a href="../mysql%E6%88%96mariadb/" class="dropdown-item">Mysql或mariadb</a>
</li>
                                    
<li>
    <a href="../neo4j/" class="dropdown-item">Neo4j相关</a>
</li>
                                    
<li>
    <a href="../pipelinedb/" class="dropdown-item">pipelinedb流式数据库介绍</a>
</li>
                                    
<li>
    <a href="../pipelinedb%E6%B5%81%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/" class="dropdown-item">Pipelinedb流式数据库介绍</a>
</li>
                                    
<li>
    <a href="../timescaledb/" class="dropdown-item">Timescaledb</a>
</li>
                                    
<li>
    <a href="../%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/" class="dropdown-item">时序数据库</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">架构设计 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E6%96%B0%E4%B8%9C%E8%A5%BF%E7%A7%AF%E7%B4%AF/" class="dropdown-item">新东西积累</a>
</li>
                                    
<li>
    <a href="../../%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1/%E7%BB%8F%E9%AA%8C%E7%B4%AF%E7%A7%AF/" class="dropdown-item">经验累积</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">经济 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E4%BB%8E%E6%9C%9F%E8%B4%A7%E8%B5%9A%E5%88%B0%E4%B8%80%E5%8D%83%E4%B8%87/" class="dropdown-item">从期货赚到一千万</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E5%85%AD%E7%88%BB%E6%B5%8B%E8%82%A1%E7%A5%A8/" class="dropdown-item">六爻预测股票起卦方法（很重要）</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E5%BD%BC%E5%BE%97%E6%9E%97%E5%A5%87%E7%AC%94%E8%AE%B0/" class="dropdown-item">彼得林奇笔记</a>
</li>
                                    
<li>
    <a href="../../%E7%BB%8F%E6%B5%8E/%E8%B6%85%E4%BD%8E%E4%BB%B7%E9%A2%84%E5%94%AE%E5%A5%97%E8%B7%AF/" class="dropdown-item">超低价预售套路</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../Citus%E9%9B%86%E7%BE%A4%E4%BD%BF%E7%94%A8/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../Lcpg%E5%86%85%E9%83%A8%E5%8F%91%E8%A1%8C%E7%89%88%E4%BD%BF%E7%94%A8/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#gpmdb" class="nav-link">gp/mdb集群内存配置</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#postgres" class="nav-link">POSTGRES 层面内存设置</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gpmdb_1" class="nav-link">GP/MDB层面内存设置</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pgbouncer" class="nav-link">pgbouncer配置</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#etcmatrixdbpgbouncerini" class="nav-link">/etc/matrixdb/pgbouncer.ini</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#etcmatrixdbpg_hbaconf" class="nav-link">/etc/matrixdb/pg_hba.conf</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#etcmatrixdbsupervisorpgbouncerconf" class="nav-link">新增文件/etc/matrixdb/supervisor.pgbouncer.conf</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#etcmatrixdbsupervisorconf-includefiles" class="nav-link">修改/etc/matrixdb/supervisor.conf 在最后include段的files配置项的值后追加下面内容（注意和原有内容之间有个空格）</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">程序配置</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#dataxjdbcurl6543" class="nav-link">datax或者有jdbcurl可以配置的程序在参数里增加下面这个设置项,端口使用连接池的6543端口</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#ftp2gp6543" class="nav-link">其他类型程序比如ftp2gp类型的单纯修改端口为6543即可。</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">排查尚未通过连接池链接的应用</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#psql5432" class="nav-link">命令行的psql无需修改，依然通过原来的5432链接</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="gpmdb">gp/mdb集群内存配置</h1>
<blockquote>
<p>由于postgres为多进程模式，在设置好内存各参数的情况下还必须结合服务端连接池来降低资源占用压力。</p>
</blockquote>
<h2 id="postgres">POSTGRES 层面内存设置</h2>
<ul>
<li>shared_buffers 一般为物理内存的25%</li>
<li>Effective_cache_size 用于优化查询器内存估算使用，一般为内存的1/2到3/4</li>
<li>work_mem 主要用于结果排序，单个连接最少使用一份work_mem的内存，最大连接数设置需要参考此项，注意并非一个连接只占用一份work_mem！！一个复杂查询可能会占用多份的work_mem的内存，默认32MB</li>
<li>maintenance_work_mem 用于维护使用的最大内存量Vacuum、Create Index和Alter Table Add Foreign Key 默认64MB，由于通常正常运行的数据库中不会有大量并发的此类操作，可以设置的较大一些，提高清理和创建索引外键的速度。</li>
<li>wal_buffers 在PostgreSQL 12版中，默认值为-1，也就是选择等于shared_buffers的1/32 。如果自动的选择太大或太小可以手工设置该值。一般考虑设置为16MB。</li>
<li>temp_buffers 设置每个数据库会话使用的临时缓冲区的最大数目。此本地缓冲区只用于访问临时表。临时缓冲区是在某个连接会话的服务进程中分配的，属于本地内存。临时缓冲区的大小也是按数据块大小分配的，默认8MB。</li>
</ul>
<h2 id="gpmdb_1">GP/MDB层面内存设置</h2>
<ul>
<li>gp_vmem_protect_limit 物理内存 × 0.9 ÷ 主机上分片数量（激进点就除主分片数量）单位MB</li>
</ul>
<pre><code># 以单个节点256GB内存分片数12（6主+6从）为例的最佳配置
# 可分配内存以实际内存的90%（给系统预留一些）256*0.9=230GB
# 单个分片最大可用内存为230/12=19GB 
# 使用https://pgtune.leopard.in.ua/ 工具计算
# 核心数48/12=4
# DB Version: 13
# OS Type: linux
# DB Type: mixed
# Total Memory (RAM): 19 GB
# CPUs num: 4
# Data Storage: hdd
#主节点连接数
max_connections = 100
shared_buffers = 4864MB
effective_cache_size = 14592MB
maintenance_work_mem = 1216MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
random_page_cost = 4
effective_io_concurrency = 2
work_mem = 12451kB
min_wal_size = 1GB
max_wal_size = 4GB
#max_worker_processes = 4
#max_parallel_workers_per_gather = 2
#max_parallel_workers = 4
#max_parallel_maintenance_workers = 2
gp_vmem_protect_limit=11831
statement_mem=200MB
#数据节点连接数gpconfig -c max_connections -m 100 -v 500
max_connections=500
max_prepared_transactions =100
</code></pre>
<pre><code># 单节点500GB内存分片数8（4主4从）为例
# 500*0.9=450GB
# 单个分片最大可用内存=450/8=56GB
# 核心数56/8=7
# DB Version: 13
# OS Type: linux
# DB Type: mixed
# Total Memory (RAM): 56 GB
# CPUs num: 7
# Data Storage: hdd

max_connections = 150
shared_buffers = 14GB
effective_cache_size = 42GB
maintenance_work_mem = 2GB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
random_page_cost = 4
effective_io_concurrency = 2
work_mem = 18350kB
min_wal_size = 1GB
max_wal_size = 4GB
max_worker_processes = 7
max_parallel_workers_per_gather = 4
max_parallel_workers = 7
max_parallel_maintenance_workers = 4
gp_vmem_protect_limit=50864
statement_mem=400MB
#数据节点连接数gpconfig -c max_connections -m 150 -v 750
max_connections=750
max_prepared_transactions =150
</code></pre>
<blockquote>
<p>上述参数需要通过gpconfig -c work_mem -m '18350kB' -v '18350kB' 这样的形式在管理节点统一执行，这样才能自动分发到数据节点去</p>
</blockquote>
<h2 id="pgbouncer">pgbouncer配置</h2>
<ul>
<li>准备日志和pid目录</li>
</ul>
<pre><code class="language-bash">mkdir /var/log/pgbouncer
chown mxadmin:mxadmin -R /var/log/pgbouncer
mkdir /var/run/pgbouncer
chown mxadmin:mxadmin -R /var/run/pgbouncer

</code></pre>
<ul>
<li>创建连接池配置文件</li>
</ul>
<pre><code>#/etc/matrixdb/pguserlist.txt 这里的内容来自与psql -c &quot;select usename,passwd from pg_shadow;&quot;,查出的结果给值都加上双引号放进来即可。
&quot;mxadmin&quot;   &quot;md5d802636a5d23d0fd440e212213e94d92&quot;
</code></pre>
<h1 id="etcmatrixdbpgbouncerini">/etc/matrixdb/pgbouncer.ini</h1>
<p>[databases]
lhcz1 = host=127.0.0.1 port=5433
lhcz = host=127.0.0.1 port=5434
[pgbouncer]
logfile = /var/log/pgbouncer/pgbouncer.log
log_connections=0
log_disconnections=0
log_stats=0
pidfile = /var/run/pgbouncer/pgbouncer.pid
listen_addr = 0.0.0.0
listen_port = 5432
auth_type = hba
auth_file = /etc/matrixdb/pguserlist.txt
auth_hba_file = /etc/matrixdb/pg_hba.conf
admin_users = mxadmin,hjdev
stats_users = stats
pool_mode = transaction
server_reset_query = DISCARD ALL
max_client_conn = 800
default_pool_size = 100
ignore_startup_parameters = extra_float_digits,geqo</p>
<pre><code></code></pre>
<h1 id="etcmatrixdbpg_hbaconf">/etc/matrixdb/pg_hba.conf</h1>
<p>local   all all trust
host    all all 0.0.0.0/0   md5</p>
<pre><code>
+ 使连接池保持自启动
</code></pre>
<h1 id="etcmatrixdbsupervisorpgbouncerconf">新增文件/etc/matrixdb/supervisor.pgbouncer.conf</h1>
<p>[program:pgbouncer]
  process_name=pgbouncer
  command=/usr/local/matrixdb/bin/pgbouncer /etc/matrixdb/pgbouncer.ini -u mxadmin
  directory=/etc/matrixdb
  autostart=true
  autorestart=unexpected
  exitcodes=0
  process_num=1
  numprocs_start=0
  stopsignal=TERM
  stopwaitsecs=5
  stopasgroup=true
  killasgroup=true
  stdout_logfile=%(ENV_MXLOGDIR)s/pgbouncer.log
  stdout_logfile_maxbytes=50MB
  stdout_logfile_backups=10
  redirect_stderr=true</p>
<pre><code></code></pre>
<h1 id="etcmatrixdbsupervisorconf-includefiles">修改/etc/matrixdb/supervisor.conf 在最后include段的files配置项的值后追加下面内容（注意和原有内容之间有个空格）</h1>
<p>supervisor.pgbouncer.conf</p>
<pre><code>+ 查看与重启
```bash
/usr/local/matrixdb/bin/supervisord -c /etc/matrixdb/supervisor.conf ctl -s http://localhost:4617 -u matrixdb -P changeme status
/usr/local/matrixdb/bin/supervisord -c /etc/matrixdb/supervisor.conf ctl -s http://localhost:4617 -u matrixdb -P changeme restart pgbouncer
</code></pre>
<h2 id="_1">程序配置</h2>
<h1 id="dataxjdbcurl6543">datax或者有jdbcurl可以配置的程序在参数里增加下面这个设置项,端口使用连接池的6543端口</h1>
<p>prepareThreshold=0</p>
<h1 id="ftp2gp6543">其他类型程序比如ftp2gp类型的单纯修改端口为6543即可。</h1>
<h2 id="_2">排查尚未通过连接池链接的应用</h2>
<h1 id="psql5432">命令行的psql无需修改，依然通过原来的5432链接</h1>
<pre><code class="language-sql">select client_addr,client_port,usename,application_name,state,pid from pg_stat_activity ;
#可以查询出客户端链接的ip和端口比如ip尾号123端口1234可以ssh链接过去netstat -anop|grep 1234找到对应的进程号，再通过ps -aux|grep 进程号找到使哪个程序，修改其配置重启即可。
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
